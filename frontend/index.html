// LOGIN
signInBtn.addEventListener("click", async () => {
    const formData = new FormData();
    formData.append("email", emailInput.value);
    formData.append("password", passwordInput.value);
    
    const res = await fetch("http://127.0.0.1:8000/login", { method: "POST", body: formData });
    const data = await res.json();
    if(data.status === "success"){
        loginPage.style.display = "none";
        dashboardPage.style.display = "block";
        document.body.classList.add("dashboard");
        userEmail.textContent = emailInput.value;
    } else {
        alert("Login failed: " + data.message);
    }
});

// GENERATE AI EMAIL
document.querySelector(".red-btn").addEventListener("click", async () => {
    const desc = document.querySelector("textarea").value;
    const formData = new FormData();
    formData.append("description", desc);
    const res = await fetch("http://127.0.0.1:8000/generate", { method: "POST", body: formData });
    const data = await res.json();
    document.querySelector("input[placeholder='Email subject line']").value = data.subject;
    document.querySelector("textarea[placeholder='Write your email content here...']").value = data.body;
});

// SEND EMAIL
document.querySelector(".send-btn").addEventListener("click", async () => {
    const subject = document.querySelector("input[placeholder='Email subject line']").value;
    const body = document.querySelector("textarea[placeholder='Write your email content here...']").value;
    const contactsFile = document.querySelector(".upload-box input[type=file]").files[0];
    const formData = new FormData();
    formData.append("subject", subject);
    formData.append("body", body);
    formData.append("contacts_file", contactsFile);
    const res = await fetch("http://127.0.0.1:8000/send", { method: "POST", body: formData });
    const data = await res.json();
    console.log(data.logs);
    alert("Emails sent! Check console for logs.");
});
